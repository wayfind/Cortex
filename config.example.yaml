# Cortex 配置示例
# 复制此文件为 config.yaml 并修改相应配置

# Agent 配置
agent:
  id: "node-001"  # 节点唯一标识
  name: "Cortex Node 1"  # 节点名称
  mode: "standalone"  # 运行模式: standalone | cluster

  # 集群模式配置（仅在 mode=cluster 时需要）
  upstream_monitor_url: ""  # 上级 Monitor URL，如 https://monitor.example.com

# Probe 配置
probe:
  schedule: "*/5 * * * *"  # Cron 表达式：每 5 分钟执行一次
  timeout: 300  # 巡检超时时间（秒）

  # 巡检项目配置
  checks:
    system_health: true  # 系统健康检查
    service_status: true  # 服务状态检查
    log_analysis: true  # 日志分析
    network_check: true  # 网络连通性检查

  # 阈值配置
  thresholds:
    cpu_percent: 80  # CPU 使用率告警阈值
    memory_percent: 85  # 内存使用率告警阈值
    disk_percent: 90  # 磁盘使用率告警阈值

# Monitor 配置
monitor:
  host: "0.0.0.0"  # 监听地址
  port: 8000  # 监听端口
  database_url: "sqlite:///./cortex.db"  # 数据库 URL

  # 节点注册配置
  registration_token: "your-secret-registration-token"  # 节点注册密钥

# Claude API 配置
claude:
  api_key: "${ANTHROPIC_API_KEY}"  # Claude API Key（建议使用环境变量）
  model: "claude-sonnet-4"  # 模型名称
  max_tokens: 2000  # 最大 token 数
  timeout: 30  # 请求超时时间（秒）

# Telegram 通知配置
telegram:
  enabled: false  # 是否启用 Telegram 通知
  bot_token: "${TELEGRAM_BOT_TOKEN}"  # Bot Token（环境变量）
  chat_id: "${TELEGRAM_CHAT_ID}"  # Chat ID（环境变量）

# Intent-Engine 配置
intent_engine:
  enabled: true  # 是否启用意图记录
  database_url: "sqlite:///./cortex_intents.db"  # Intent 数据库 URL

# 日志配置
logging:
  level: "INFO"  # 日志级别: DEBUG | INFO | WARNING | ERROR | CRITICAL
  format: "json"  # 日志格式: json | text
  file: "logs/cortex.log"  # 日志文件路径
  rotation: "1 day"  # 日志轮转策略
  retention: "30 days"  # 日志保留时间

# 认证配置
auth:
  secret_key: "${SECRET_KEY}"  # JWT 密钥（环境变量）
  algorithm: "HS256"  # JWT 算法
  access_token_expire_minutes: 30  # Token 过期时间（分钟）

# 性能配置
performance:
  # API 速率限制
  rate_limit:
    enabled: true
    reports: 100  # 上报接口限制（次/分钟/节点）
    queries: 1000  # 查询接口限制（次/分钟/用户）

  # 缓存配置
  cache:
    enabled: false  # 是否启用缓存
    backend: "memory"  # 缓存后端: memory | redis
    redis_url: "redis://localhost:6379/0"  # Redis URL（如使用）

# 数据保留策略
data_retention:
  reports_days: 30  # 报告保留天数
  alerts_days: 90  # 告警保留天数（已解决）
  decisions_days: 180  # 决策记录保留天数
